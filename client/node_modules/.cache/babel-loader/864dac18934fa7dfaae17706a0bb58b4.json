{"ast":null,"code":"import _initializerDefineProperty from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/initializerDefineProperty\";\nimport _classCallCheck from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _applyDecoratedDescriptor from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor\";\nimport _initializerWarningHelper from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/initializerWarningHelper\";\n\nvar _class, _descriptor;\n\nimport { observable, action } from 'mobx';\nvar RESTClient = (_class =\n/*#__PURE__*/\nfunction () {\n  function RESTClient(apiURI, token) {\n    _classCallCheck(this, RESTClient);\n\n    this.apiURI = '';\n\n    _initializerDefineProperty(this, \"token\", _descriptor, this);\n\n    this.apiURI = apiURI;\n    this.token = token;\n  }\n\n  _createClass(RESTClient, [{\n    key: \"authenticate\",\n    value: function authenticate(user, password) {\n      var _this = this;\n\n      var authPath = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '/login';\n      var credentials = Buffer(\"\".concat(user, \":\").concat(password)).toString('base64');\n      return this.sendRequest(authPath, 'POST', {\n        email: user,\n        password: password\n      }, false).then(function (res) {\n        _this.token = res['results']['token'] || res['results'];\n        return res.results;\n      }).catch(function (error) {\n        return Promise.reject(error);\n      });\n    }\n  }, {\n    key: \"password_recovery\",\n    value: function password_recovery(email) {\n      var authPath = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '/users/password_recovery';\n      return this.sendRequest(authPath, 'POST', {\n        email: email\n      }, false);\n    }\n  }, {\n    key: \"update_password\",\n    value: function update_password(token, password) {\n      var authPath = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '/users/password_update';\n      return this.sendRequest(authPath, 'POST', {\n        password_reset_token: token,\n        password: password\n      }, false);\n    }\n  }, {\n    key: \"search\",\n    value: function search(uriPath) {\n      var filters = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var secure = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      return this.sendRequest(\"\".concat(uriPath).concat(this.getFiltersUrl(filters)), 'GET', null, secure);\n    }\n  }, {\n    key: \"get\",\n    value: function get(uriPath) {\n      var id = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      var filters = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return this.sendRequest(id ? \"\".concat(uriPath, \"/\").concat(id).concat(this.getFiltersUrl(filters)) : \"\".concat(uriPath).concat(this.getFiltersUrl(filters)), 'GET');\n    }\n  }, {\n    key: \"post\",\n    value: function post(uriPath, item) {\n      return this.sendRequest(uriPath, 'POST', item.toParams ? item.toParams() : item);\n    }\n  }, {\n    key: \"put\",\n    value: function put(uriPath, item) {\n      var itemId = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      return this.sendRequest(\"\".concat(uriPath, \"/\").concat(itemId || item.id), 'PUT', item.toParams ? item.toParams() : item);\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete(uriPath, id) {\n      return this.sendRequest(\"\".concat(uriPath, \"/\").concat(id), 'DELETE');\n    }\n  }, {\n    key: \"sendRequest\",\n    value: function sendRequest(uriPath) {\n      var method = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'GET';\n      var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var secure = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n      var customHeaders = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n      var url = \"\".concat(this.apiURI).concat(uriPath);\n      var headers = {\n        'Content-Type': 'application/json',\n        'pragma': 'no-cache',\n        'cache-control': 'no-cache',\n        'mode': 'no-cors'\n      };\n      var request = {\n        'method': method,\n        'headers': headers\n      };\n\n      if (method != 'GET' && params != null) {\n        request = Object.assign(request, {\n          body: JSON.stringify(params)\n        });\n      }\n\n      return fetch(url, request).then(function (res) {\n        if (res.ok) {\n          var _headers = {};\n          var _iteratorNormalCompletion = true;\n          var _didIteratorError = false;\n          var _iteratorError = undefined;\n\n          try {\n            for (var _iterator = res.headers.entries()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n              var h = _step.value;\n              _headers[[h[0]][0]] = [h[1]][0];\n            }\n          } catch (err) {\n            _didIteratorError = true;\n            _iteratorError = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion && _iterator.return != null) {\n                _iterator.return();\n              }\n            } finally {\n              if (_didIteratorError) {\n                throw _iteratorError;\n              }\n            }\n          }\n\n          return res.json().then(function (content) {\n            return {\n              results: content.results || content,\n              headers: _headers\n            };\n          }).catch(function (err) {\n            return Promise.resolve(res); // empthy response\n          });\n        }\n\n        debugger;\n        return res.json().then(function (content) {\n          return Promise.reject(new Error(JSON.stringify(content)));\n        });\n      }).catch(function (err) {\n        debugger;\n        return Promise.reject(err);\n      });\n    }\n  }, {\n    key: \"parseFilterValue\",\n    value: function parseFilterValue(value) {\n      if (value._isAMomentObject) {\n        return value.toISOString();\n      }\n\n      return value;\n    }\n  }, {\n    key: \"getFiltersUrl\",\n    value: function getFiltersUrl(filters) {\n      var result = [];\n\n      for (var key in filters) {\n        if (filters[key] == undefined) {\n          // what is this case for?\n          result.push(key);\n        } else {\n          result.push(\"\".concat(key, \"=\").concat(this.parseFilterValue(filters[key])));\n        }\n      }\n\n      return \"?\".concat(result.join('&'));\n    }\n  }]);\n\n  return RESTClient;\n}(), (_descriptor = _applyDecoratedDescriptor(_class.prototype, \"token\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return null;\n  }\n}), _applyDecoratedDescriptor(_class.prototype, \"authenticate\", [action], Object.getOwnPropertyDescriptor(_class.prototype, \"authenticate\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"password_recovery\", [action], Object.getOwnPropertyDescriptor(_class.prototype, \"password_recovery\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"update_password\", [action], Object.getOwnPropertyDescriptor(_class.prototype, \"update_password\"), _class.prototype)), _class);\nexport { RESTClient as default };","map":{"version":3,"sources":["/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/src/lib/RESTClient.js"],"names":["observable","action","RESTClient","apiURI","token","user","password","authPath","credentials","Buffer","toString","sendRequest","email","then","res","results","catch","error","Promise","reject","password_reset_token","uriPath","filters","secure","getFiltersUrl","id","item","toParams","itemId","method","params","customHeaders","url","headers","request","Object","assign","body","JSON","stringify","fetch","ok","entries","h","json","content","err","resolve","Error","value","_isAMomentObject","toISOString","result","key","undefined","push","parseFilterValue","join"],"mappings":"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","sourcesContent":["import {\n  observable,\n  action,\n} from 'mobx'\n\nexport default class RESTClient {\n  apiURI = '';\n  @observable token = null;\n\n  constructor( apiURI, token ) {\n    this.apiURI = apiURI;\n    this.token = token;\n  }\n\n  @action\n  authenticate( user, password, authPath = '/login' ) {\n    let credentials = Buffer(`${user}:${password}`).toString('base64');\n    return this.sendRequest(authPath, 'POST', {email: user, password: password}, false)\n      .then( res => {\n        this.token = res['results']['token'] || res['results'];\n        return res.results;\n      })\n      .catch( error => {\n        return Promise.reject(error)\n      })\n  }\n\n  @action\n  password_recovery( email, authPath = '/users/password_recovery') {\n    return this.sendRequest( authPath, 'POST', { email: email }, false)\n  }\n\n  @action\n  update_password( token, password, authPath = '/users/password_update') {\n    return this.sendRequest( authPath, 'POST', { password_reset_token: token, password: password }, false );\n  }\n\n  search(uriPath, filters = {}, secure = true) {\n\n    return this.sendRequest(\n        `${uriPath}${this.getFiltersUrl(filters)}`,\n        'GET',\n        null,\n        secure);\n  }\n\n  get(uriPath, id = null, filters = {}) {\n    return this.sendRequest(\n      id ? `${uriPath}/${id}${this.getFiltersUrl(filters)}` :  `${uriPath}${this.getFiltersUrl(filters)}`, \n      'GET');\n  }\n\n  post(uriPath, item) {\n    return this.sendRequest(\n      uriPath, \n      'POST', \n      item.toParams ? item.toParams() : item );\n  }\n\n  put(uriPath, item, itemId = null) {\n    return this.sendRequest(\n      `${uriPath}/${itemId || item.id}`,  \n      'PUT', \n      item.toParams ? item.toParams() : item );\n  }\n\n  delete(uriPath, id) {\n    return this.sendRequest(\n      `${uriPath}/${id}`, \n      'DELETE');\n  }\n\n  sendRequest(uriPath, method = 'GET', params = null, secure = true, customHeaders = {}) {\n\n    const url = `${this.apiURI}${uriPath}`;\n\n    let headers = {\n        'Content-Type': 'application/json',\n        'pragma': 'no-cache',\n        'cache-control': 'no-cache',\n        'mode': 'no-cors'\n      };\n\n    let request = {\n        'method': method,\n        'headers': headers,\n      };\n\n    if ( method != 'GET' && params != null ) {\n      request = Object.assign( request, {\n        body: JSON.stringify(params),\n      });\n    }\n    return fetch( url, request )\n      .then( res => {\n        if ( res.ok ) {\n          let headers = {};\n          \n          for(var h of res.headers.entries()) {\n              headers[[h[0]][0]] = [h[1]][0];\n          }\n          return res.json().then( content => ({\n            results: content.results || content,\n            headers: headers\n          })).catch(err => { \n              return Promise.resolve(res); // empthy response\n          });\n        }\n        debugger\n        return res.json().then( content => {\n          return Promise.reject(new Error(JSON.stringify(content)))\n        })\n      })\n      .catch( err => {\n          debugger\n          return Promise.reject(err);\n      });\n\n  }\n\n  parseFilterValue( value ) {\n\n    if ( value._isAMomentObject )\n    {\n      return value.toISOString();\n    }\n\n    return value;\n  }\n\n  getFiltersUrl(filters) {\n    let result = [];\n\n    for (var key in filters) {\n      if ( filters[key] == undefined ) { // what is this case for?\n        result.push(key);\n      }\n      else {\n        result.push(`${key}=${this.parseFilterValue(filters[key])}`);\n      }\n    }\n\n    return `?${result.join('&')}`;\n  }  \n}\n"]},"metadata":{},"sourceType":"module"}