{"ast":null,"code":"import _initializerDefineProperty from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/initializerDefineProperty\";\nimport _classCallCheck from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _applyDecoratedDescriptor from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor\";\nimport _initializerWarningHelper from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/initializerWarningHelper\";\n\nvar _class, _descriptor;\n\nimport { observable, action } from 'mobx';\nvar RESTClient = (_class =\n/*#__PURE__*/\nfunction () {\n  function RESTClient(apiURI, token) {\n    _classCallCheck(this, RESTClient);\n\n    this.apiURI = '';\n\n    _initializerDefineProperty(this, \"token\", _descriptor, this);\n\n    this.apiURI = apiURI;\n    this.token = token;\n  }\n\n  _createClass(RESTClient, [{\n    key: \"authenticate\",\n    value: function authenticate(user, password) {// let credentials = Buffer(`${user}:${password}`).toString('base64');\n      // return this.sendRequest( authPath, 'POST', {}, false, {\n      //     'Authorization': `Basic ${credentials}`,\n      //   })\n      //   .then( res => {\n      //     this.token = res['results']['token'] || res['results'];\n      //     return res['results'];\n      //   },\n      //   err => {\n      //     return Promise.reject(err);\n      //   });\n\n      var authPath = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '/authenticate';\n    }\n  }, {\n    key: \"password_recovery\",\n    value: function password_recovery(email) {\n      var authPath = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '/users/password_recovery';\n      return this.sendRequest(authPath, 'POST', {\n        email: email\n      }, false);\n    }\n  }, {\n    key: \"update_password\",\n    value: function update_password(token, password) {\n      var authPath = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '/users/password_update';\n      return this.sendRequest(authPath, 'POST', {\n        password_reset_token: token,\n        password: password\n      }, false);\n    }\n  }, {\n    key: \"search\",\n    value: function search(uriPath) {\n      var filters = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var secure = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      return this.sendRequest(\"\".concat(uriPath).concat(this.getFiltersUrl(filters)), 'GET', null, secure);\n    }\n  }, {\n    key: \"get\",\n    value: function get(uriPath) {\n      var id = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      var filters = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return this.sendRequest(id ? \"\".concat(uriPath, \"/\").concat(id).concat(this.getFiltersUrl(filters)) : \"\".concat(uriPath).concat(this.getFiltersUrl(filters)), 'GET');\n    }\n  }, {\n    key: \"post\",\n    value: function post(uriPath, item) {\n      return this.sendRequest(uriPath, 'POST', item.toParams ? item.toParams() : item);\n    }\n  }, {\n    key: \"put\",\n    value: function put(uriPath, item) {\n      var itemId = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      return this.sendRequest(\"\".concat(uriPath, \"/\").concat(itemId || item.id), 'PUT', item.toParams ? item.toParams() : item);\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete(uriPath, id) {\n      return this.sendRequest(\"\".concat(uriPath, \"/\").concat(id), 'DELETE');\n    }\n  }, {\n    key: \"sendRequest\",\n    value: function sendRequest(uriPath) {\n      var method = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'GET';\n      var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      var secure = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n      var customHeaders = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n      var url = \"\".concat(this.apiURI).concat(uriPath);\n      var headers = {\n        'Content-Type': 'application/json',\n        'pragma': 'no-cache',\n        'cache-control': 'no-cache'\n      };\n      var request = {\n        'method': method,\n        'headers': headers\n      };\n\n      if (secure) {\n        if (this.token) {\n          headers = Object.assign(headers, {\n            'Authorization': \"Bearer \".concat(this.token)\n          }, customHeaders);\n        } else {\n          return Promise.reject(new Error('Not authenticated yet.'));\n        }\n      } else {\n        headers = Object.assign(headers, customHeaders);\n      }\n\n      if (method != 'GET' && params != null) {\n        request = Object.assign(request, {\n          body: JSON.stringify(params)\n        });\n      }\n\n      return fetch(url, request).then(function (res) {\n        if (res.ok) {\n          var _headers = {};\n          var _iteratorNormalCompletion = true;\n          var _didIteratorError = false;\n          var _iteratorError = undefined;\n\n          try {\n            for (var _iterator = res.headers.entries()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n              var h = _step.value;\n              _headers[[h[0]][0]] = [h[1]][0];\n            }\n          } catch (err) {\n            _didIteratorError = true;\n            _iteratorError = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion && _iterator.return != null) {\n                _iterator.return();\n              }\n            } finally {\n              if (_didIteratorError) {\n                throw _iteratorError;\n              }\n            }\n          }\n\n          return res.json().then(function (content) {\n            return {\n              results: content.results || content,\n              headers: _headers\n            };\n          }).catch(function (err) {\n            return Promise.resolve(res); // empthy response\n          });\n        }\n\n        return res.json().then(function (content) {\n          return Promise.reject(new Error(JSON.stringify(content)));\n        });\n      }).catch(function (err) {\n        return Promise.reject(err);\n      });\n    }\n  }, {\n    key: \"parseFilterValue\",\n    value: function parseFilterValue(value) {\n      if (value._isAMomentObject) {\n        return value.toISOString();\n      }\n\n      return value;\n    }\n  }, {\n    key: \"getFiltersUrl\",\n    value: function getFiltersUrl(filters) {\n      var result = [];\n\n      for (var key in filters) {\n        if (filters[key] == undefined) {\n          // what is this case for?\n          result.push(key);\n        } else {\n          result.push(\"\".concat(key, \"=\").concat(this.parseFilterValue(filters[key])));\n        }\n      }\n\n      return \"?\".concat(result.join('&'));\n    }\n  }]);\n\n  return RESTClient;\n}(), (_descriptor = _applyDecoratedDescriptor(_class.prototype, \"token\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return null;\n  }\n}), _applyDecoratedDescriptor(_class.prototype, \"authenticate\", [action], Object.getOwnPropertyDescriptor(_class.prototype, \"authenticate\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"password_recovery\", [action], Object.getOwnPropertyDescriptor(_class.prototype, \"password_recovery\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"update_password\", [action], Object.getOwnPropertyDescriptor(_class.prototype, \"update_password\"), _class.prototype)), _class);\nexport { RESTClient as default };","map":{"version":3,"sources":["/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/src/lib/RESTClient.js"],"names":["observable","action","RESTClient","apiURI","token","user","password","authPath","email","sendRequest","password_reset_token","uriPath","filters","secure","getFiltersUrl","id","item","toParams","itemId","method","params","customHeaders","url","headers","request","Object","assign","Promise","reject","Error","body","JSON","stringify","fetch","then","res","ok","entries","h","json","content","results","catch","err","resolve","value","_isAMomentObject","toISOString","result","key","undefined","push","parseFilterValue","join"],"mappings":";;;;;;;;AAAA,SACEA,UADF,EAEEC,MAFF,QAGO,MAHP;IAKqBC,U;;;AAInB,sBAAaC,MAAb,EAAqBC,KAArB,EAA6B;AAAA;;AAAA,SAH7BD,MAG6B,GAHpB,EAGoB;;AAAA;;AAC3B,SAAKA,MAAL,GAAcA,MAAd;AACA,SAAKC,KAAL,GAAaA,KAAb;AACD;;;;iCAGaC,I,EAAMC,Q,EAAuC,CACzD;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAZyD,UAA7BC,QAA6B,uEAAlB,eAAkB;AAa1D;;;sCAGkBC,K,EAA8C;AAAA,UAAvCD,QAAuC,uEAA5B,0BAA4B;AAC/D,aAAO,KAAKE,WAAL,CAAkBF,QAAlB,EAA4B,MAA5B,EAAoC;AAAEC,QAAAA,KAAK,EAAEA;AAAT,OAApC,EAAsD,KAAtD,CAAP;AACD;;;oCAGgBJ,K,EAAOE,Q,EAA+C;AAAA,UAArCC,QAAqC,uEAA1B,wBAA0B;AACrE,aAAO,KAAKE,WAAL,CAAkBF,QAAlB,EAA4B,MAA5B,EAAoC;AAAEG,QAAAA,oBAAoB,EAAEN,KAAxB;AAA+BE,QAAAA,QAAQ,EAAEA;AAAzC,OAApC,EAAyF,KAAzF,CAAP;AACD;;;2BAEMK,O,EAAsC;AAAA,UAA7BC,OAA6B,uEAAnB,EAAmB;AAAA,UAAfC,MAAe,uEAAN,IAAM;AAE3C,aAAO,KAAKJ,WAAL,WACAE,OADA,SACU,KAAKG,aAAL,CAAmBF,OAAnB,CADV,GAEH,KAFG,EAGH,IAHG,EAIHC,MAJG,CAAP;AAKD;;;wBAEGF,O,EAAkC;AAAA,UAAzBI,EAAyB,uEAApB,IAAoB;AAAA,UAAdH,OAAc,uEAAJ,EAAI;AACpC,aAAO,KAAKH,WAAL,CACLM,EAAE,aAAMJ,OAAN,cAAiBI,EAAjB,SAAsB,KAAKD,aAAL,CAAmBF,OAAnB,CAAtB,cAA0DD,OAA1D,SAAoE,KAAKG,aAAL,CAAmBF,OAAnB,CAApE,CADG,EAEL,KAFK,CAAP;AAGD;;;yBAEID,O,EAASK,I,EAAM;AAClB,aAAO,KAAKP,WAAL,CACLE,OADK,EAEL,MAFK,EAGLK,IAAI,CAACC,QAAL,GAAgBD,IAAI,CAACC,QAAL,EAAhB,GAAkCD,IAH7B,CAAP;AAID;;;wBAEGL,O,EAASK,I,EAAqB;AAAA,UAAfE,MAAe,uEAAN,IAAM;AAChC,aAAO,KAAKT,WAAL,WACFE,OADE,cACSO,MAAM,IAAIF,IAAI,CAACD,EADxB,GAEL,KAFK,EAGLC,IAAI,CAACC,QAAL,GAAgBD,IAAI,CAACC,QAAL,EAAhB,GAAkCD,IAH7B,CAAP;AAID;;;4BAEML,O,EAASI,E,EAAI;AAClB,aAAO,KAAKN,WAAL,WACFE,OADE,cACSI,EADT,GAEL,QAFK,CAAP;AAGD;;;gCAEWJ,O,EAA2E;AAAA,UAAlEQ,MAAkE,uEAAzD,KAAyD;AAAA,UAAlDC,MAAkD,uEAAzC,IAAyC;AAAA,UAAnCP,MAAmC,uEAA1B,IAA0B;AAAA,UAApBQ,aAAoB,uEAAJ,EAAI;AAErF,UAAMC,GAAG,aAAM,KAAKnB,MAAX,SAAoBQ,OAApB,CAAT;AAEA,UAAIY,OAAO,GAAG;AACV,wBAAgB,kBADN;AAEV,kBAAU,UAFA;AAGV,yBAAiB;AAHP,OAAd;AAMA,UAAIC,OAAO,GAAG;AACV,kBAAUL,MADA;AAEV,mBAAWI;AAFD,OAAd;;AAMA,UAAKV,MAAL,EAAc;AACZ,YAAK,KAAKT,KAAV,EAAkB;AAChBmB,UAAAA,OAAO,GAAGE,MAAM,CAACC,MAAP,CACRH,OADQ,EAER;AACE,8CAA2B,KAAKnB,KAAhC;AADF,WAFQ,EAKRiB,aALQ,CAAV;AAMD,SAPD,MAQK;AACH,iBAAOM,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,wBAAV,CAAf,CAAP;AACD;AACF,OAZD,MAaK;AACHN,QAAAA,OAAO,GAAGE,MAAM,CAACC,MAAP,CAAeH,OAAf,EAAwBF,aAAxB,CAAV;AACD;;AAED,UAAKF,MAAM,IAAI,KAAV,IAAmBC,MAAM,IAAI,IAAlC,EAAyC;AACvCI,QAAAA,OAAO,GAAGC,MAAM,CAACC,MAAP,CAAeF,OAAf,EAAwB;AAChCM,UAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeZ,MAAf;AAD0B,SAAxB,CAAV;AAGD;;AAED,aAAOa,KAAK,CAAEX,GAAF,EAAOE,OAAP,CAAL,CACJU,IADI,CACE,UAAAC,GAAG,EAAI;AACZ,YAAKA,GAAG,CAACC,EAAT,EAAc;AACZ,cAAIb,QAAO,GAAG,EAAd;AADY;AAAA;AAAA;;AAAA;AAGZ,iCAAaY,GAAG,CAACZ,OAAJ,CAAYc,OAAZ,EAAb,8HAAoC;AAAA,kBAA5BC,CAA4B;AAChCf,cAAAA,QAAO,CAAC,CAACe,CAAC,CAAC,CAAD,CAAF,EAAO,CAAP,CAAD,CAAP,GAAqB,CAACA,CAAC,CAAC,CAAD,CAAF,EAAO,CAAP,CAArB;AACH;AALW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAMZ,iBAAOH,GAAG,CAACI,IAAJ,GAAWL,IAAX,CAAiB,UAAAM,OAAO;AAAA,mBAAK;AAClCC,cAAAA,OAAO,EAAED,OAAO,CAACC,OAAR,IAAmBD,OADM;AAElCjB,cAAAA,OAAO,EAAEA;AAFyB,aAAL;AAAA,WAAxB,EAGHmB,KAHG,CAGG,UAAAC,GAAG,EAAI;AACb,mBAAOhB,OAAO,CAACiB,OAAR,CAAgBT,GAAhB,CAAP,CADa,CACgB;AAChC,WALM,CAAP;AAMD;;AACD,eAAOA,GAAG,CAACI,IAAJ,GAAWL,IAAX,CAAiB,UAAAM,OAAO,EAAI;AACjC,iBAAOb,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAUE,IAAI,CAACC,SAAL,CAAeQ,OAAf,CAAV,CAAf,CAAP;AACD,SAFM,CAAP;AAGD,OAlBI,EAmBJE,KAnBI,CAmBG,UAAAC,GAAG,EAAI;AACX,eAAOhB,OAAO,CAACC,MAAR,CAAee,GAAf,CAAP;AACH,OArBI,CAAP;AAuBD;;;qCAEiBE,K,EAAQ;AAExB,UAAKA,KAAK,CAACC,gBAAX,EACA;AACE,eAAOD,KAAK,CAACE,WAAN,EAAP;AACD;;AAED,aAAOF,KAAP;AACD;;;kCAEajC,O,EAAS;AACrB,UAAIoC,MAAM,GAAG,EAAb;;AAEA,WAAK,IAAIC,GAAT,IAAgBrC,OAAhB,EAAyB;AACvB,YAAKA,OAAO,CAACqC,GAAD,CAAP,IAAgBC,SAArB,EAAiC;AAAE;AACjCF,UAAAA,MAAM,CAACG,IAAP,CAAYF,GAAZ;AACD,SAFD,MAGK;AACHD,UAAAA,MAAM,CAACG,IAAP,WAAeF,GAAf,cAAsB,KAAKG,gBAAL,CAAsBxC,OAAO,CAACqC,GAAD,CAA7B,CAAtB;AACD;AACF;;AAED,wBAAWD,MAAM,CAACK,IAAP,CAAY,GAAZ,CAAX;AACD;;;;0EA3JArD,U;;;;;WAAmB,I;;iEAOnBC,M,2JAgBAA,M,8JAKAA,M;SA9BkBC,U","sourcesContent":["import {\n  observable,\n  action,\n} from 'mobx'\n\nexport default class RESTClient {\n  apiURI = '';\n  @observable token = null;\n\n  constructor( apiURI, token ) {\n    this.apiURI = apiURI;\n    this.token = token;\n  }\n\n  @action\n  authenticate( user, password, authPath = '/authenticate' ) {\n    // let credentials = Buffer(`${user}:${password}`).toString('base64');\n\n    // return this.sendRequest( authPath, 'POST', {}, false, {\n    //     'Authorization': `Basic ${credentials}`,\n    //   })\n    //   .then( res => {\n    //     this.token = res['results']['token'] || res['results'];\n    //     return res['results'];\n    //   },\n    //   err => {\n    //     return Promise.reject(err);\n    //   });\n  }\n\n  @action\n  password_recovery( email, authPath = '/users/password_recovery') {\n    return this.sendRequest( authPath, 'POST', { email: email }, false)\n  }\n\n  @action\n  update_password( token, password, authPath = '/users/password_update') {\n    return this.sendRequest( authPath, 'POST', { password_reset_token: token, password: password }, false );\n  }\n\n  search(uriPath, filters = {}, secure = true) {\n\n    return this.sendRequest(\n        `${uriPath}${this.getFiltersUrl(filters)}`,\n        'GET',\n        null,\n        secure);\n  }\n\n  get(uriPath, id = null, filters = {}) {\n    return this.sendRequest(\n      id ? `${uriPath}/${id}${this.getFiltersUrl(filters)}` :  `${uriPath}${this.getFiltersUrl(filters)}`, \n      'GET');\n  }\n\n  post(uriPath, item) {\n    return this.sendRequest(\n      uriPath, \n      'POST', \n      item.toParams ? item.toParams() : item );\n  }\n\n  put(uriPath, item, itemId = null) {\n    return this.sendRequest(\n      `${uriPath}/${itemId || item.id}`,  \n      'PUT', \n      item.toParams ? item.toParams() : item );\n  }\n\n  delete(uriPath, id) {\n    return this.sendRequest(\n      `${uriPath}/${id}`, \n      'DELETE');\n  }\n\n  sendRequest(uriPath, method = 'GET', params = null, secure = true, customHeaders = {}) {\n\n    const url = `${this.apiURI}${uriPath}`;\n\n    let headers = {\n        'Content-Type': 'application/json',\n        'pragma': 'no-cache',\n        'cache-control': 'no-cache',  \n      };\n\n    let request = {\n        'method': method,\n        'headers': headers,\n      };\n\n\n    if ( secure ) {\n      if ( this.token ) {\n        headers = Object.assign( \n          headers, \n          {\n            'Authorization': `Bearer ${this.token}`,\n          }, \n          customHeaders);\n      }\n      else {\n        return Promise.reject(new Error('Not authenticated yet.'));\n      }\n    }\n    else {\n      headers = Object.assign( headers, customHeaders );\n    }\n\n    if ( method != 'GET' && params != null ) {\n      request = Object.assign( request, {\n        body: JSON.stringify(params),\n      });\n    }\n\n    return fetch( url, request )\n      .then( res => {\n        if ( res.ok ) {\n          let headers = {};\n          \n          for(var h of res.headers.entries()) {\n              headers[[h[0]][0]] = [h[1]][0];\n          }\n          return res.json().then( content => ({\n            results: content.results || content,\n            headers: headers\n          })).catch(err => { \n              return Promise.resolve(res); // empthy response\n          });\n        }\n        return res.json().then( content => {\n          return Promise.reject(new Error(JSON.stringify(content)))\n        })\n      })\n      .catch( err => {\n          return Promise.reject(err);\n      });\n\n  }\n\n  parseFilterValue( value ) {\n\n    if ( value._isAMomentObject )\n    {\n      return value.toISOString();\n    }\n\n    return value;\n  }\n\n  getFiltersUrl(filters) {\n    let result = [];\n\n    for (var key in filters) {\n      if ( filters[key] == undefined ) { // what is this case for?\n        result.push(key);\n      }\n      else {\n        result.push(`${key}=${this.parseFilterValue(filters[key])}`);\n      }\n    }\n\n    return `?${result.join('&')}`;\n  }  \n}\n"]},"metadata":{},"sourceType":"module"}