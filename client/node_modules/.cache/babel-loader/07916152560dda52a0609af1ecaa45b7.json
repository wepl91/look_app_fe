{"ast":null,"code":"import _classCallCheck from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\n\nvar _class,\n    _jsxFileName = \"/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/src/components/Payments/PaymentForm.jsx\";\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport './styles.css';\nimport { Field, Text, TextInput } from 'shipnow-mercurio';\nimport { Columns, Column } from 'bloomer';\nimport { withStore } from '../../hocs';\nimport { observer } from 'mobx-react';\nimport { translate } from '../../lib/Translator';\nimport { priceRegex } from '../../lib/Regex';\nimport { faCoins, faMoneyBill } from \"@fortawesome/free-solid-svg-icons\";\n\nvar PaymentForm = observer(_class =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(PaymentForm, _Component);\n\n  function PaymentForm(props) {\n    var _this;\n\n    _classCallCheck(this, PaymentForm);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(PaymentForm).call(this, props));\n    _this.state = {\n      paymentType: '',\n      cashHalf: 0,\n      pointsHalf: 0,\n      points: 0,\n      validSplitPayment: false\n    };\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(PaymentForm, [{\n    key: \"getText\",\n    value: function getText(text) {\n      return translate(text, this.props.store.ui.language);\n    }\n  }, {\n    key: \"handlePaymentType\",\n    value: function handlePaymentType(type) {\n      this.setState({\n        paymentType: type,\n        cashHalf: 0,\n        pointsHalf: 0,\n        points: 0\n      });\n\n      if (type == 'cashAndPoints') {\n        this.props.onChange && this.props.onChange(null, null, 'cashHalf', null);\n      } else {\n        this.props.onChange && this.props.onChange(null, null, type, null);\n      }\n    }\n  }, {\n    key: \"validateCashPayment\",\n    value: function validateCashPayment(value) {\n      //agregar mensaje de error\n      return priceRegex.test(value) && value <= this.props.totalAmount;\n    }\n  }, {\n    key: \"validatePointsPayment\",\n    value: function validatePointsPayment(value) {\n      return priceRegex.test(value) && value <= this.props.clientPoints && this.getConvertedPoints(value) <= this.props.totalAmount;\n    }\n  }, {\n    key: \"getConvertedPoints\",\n    value: function getConvertedPoints(points) {\n      return this.props.store.ui.getChange('changePurchase').convertPoints(points);\n    }\n  }, {\n    key: \"handleChange\",\n    value: function handleChange(sender, value, name, valid) {\n      if (name == 'cashHalf') {\n        this.setState({\n          cashHalf: value\n        });\n        valid = this.validateCashPayment(value) && this.validatePointsPayment(this.state.pointsHalf);\n      }\n\n      if (name == 'pointsHalf') {\n        this.setState({\n          pointsHalf: value\n        });\n        valid = this.validateCashPayment(this.state.cashHalf) && this.validatePointsPayment(value);\n      }\n\n      if (name == 'points') {\n        this.setState({\n          points: value\n        });\n      }\n\n      this.props.onChange && this.props.onChange(sender, value, name, valid);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }, React.createElement(Field, {\n        label: this.getText('Tipo de pago'),\n        labelNote: this.getText('¿De qué manera desea realizar el pago?'),\n        size: \"lg\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }, React.createElement(Text, {\n        className: \"ml-1 mt-2\",\n        weight: \"medium\",\n        size: \"lg\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        className: \"ml-1 mr-1\",\n        type: \"radio\",\n        value: \"loaned\",\n        onChange: function onChange() {\n          return _this2.handlePaymentType('loaned');\n        },\n        checked: this.state.paymentType == 'loaned',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }), this.getText('Fiado')), React.createElement(Text, {\n        className: \"ml-1 mt-2\",\n        size: \"lg\",\n        weight: \"medium\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        className: \"ml-1 mr-1\",\n        type: \"radio\",\n        value: \"cash\",\n        onChange: function onChange() {\n          return _this2.handlePaymentType('cash');\n        },\n        checked: this.state.paymentType == 'cash',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }), this.getText('Efectivo')), React.createElement(Text, {\n        className: \"ml-1 mt-2\",\n        size: \"lg\",\n        weight: \"medium\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        className: \"ml-1 mr-1\",\n        type: \"radio\",\n        value: \"points\",\n        onChange: function onChange() {\n          return _this2.handlePaymentType('points');\n        },\n        checked: this.state.paymentType == 'points',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }), this.getText('Puntos')), React.createElement(Text, {\n        className: \"ml-1 mt-2\",\n        size: \"lg\",\n        weight: \"medium\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        className: \"ml-1 mr-1\",\n        type: \"radio\",\n        value: \"cashAndPoints\",\n        onChange: function onChange() {\n          return _this2.handlePaymentType('cashAndPoints');\n        },\n        checked: this.state.paymentType == 'cashAndPoints',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }), this.getText('Efectivo y puntos'))), this.state.paymentType != '' && this.state.paymentType != 'loaned' && React.createElement(Field, {\n        className: \"mt-4\",\n        label: this.getText('Ingrese los montos'),\n        labelNote: this.getText('¿Cuánto va abonar?'),\n        size: \"lg\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, this.state.paymentType == 'cash' && React.createElement(TextInput, {\n        icon: faMoneyBill,\n        name: \"cash\",\n        validate: function validate(value) {\n          return _this2.validateCashPayment(value);\n        },\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }), this.state.paymentType == 'points' && React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, React.createElement(TextInput, {\n        icon: faCoins,\n        name: \"points\",\n        validate: function validate(value) {\n          return _this2.validatePointsPayment(value);\n        },\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }), React.createElement(Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, \"\".concat(this.getText('Equivale a: $'), \" \").concat(this.getConvertedPoints(this.state.points)))), this.state.paymentType == 'cashAndPoints' && React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, React.createElement(Columns, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(Column, {\n        isSize: 6,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, React.createElement(TextInput, {\n        className: \"mt-1\",\n        icon: faMoneyBill,\n        name: \"cashHalf\",\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      })), React.createElement(Column, {\n        isSize: 6,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, React.createElement(TextInput, {\n        className: \"mt-1\",\n        icon: faCoins,\n        name: \"pointsHalf\",\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }), React.createElement(Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, \"\".concat(this.getText('Equivale a: $'), \" \").concat(this.getConvertedPoints(this.state.pointsHalf))))))));\n    }\n  }]);\n\n  return PaymentForm;\n}(Component)) || _class;\n\nPaymentForm.PropTypes = {\n  totalAmount: PropTypes.number,\n  clientPoints: PropTypes.number,\n  onChange: PropTypes.func\n};\nPaymentForm.defaultProps = {\n  totalAmount: 0,\n  clientPoints: 0,\n  onChange: null\n};\nexport default withStore(PaymentForm);","map":{"version":3,"sources":["/Users/wpereyra/Documents/Universidad/PP1/look_app_fe/src/components/Payments/PaymentForm.jsx"],"names":["React","Component","PropTypes","Field","Text","TextInput","Columns","Column","withStore","observer","translate","priceRegex","faCoins","faMoneyBill","PaymentForm","props","state","paymentType","cashHalf","pointsHalf","points","validSplitPayment","handleChange","bind","text","store","ui","language","type","setState","onChange","value","test","totalAmount","clientPoints","getConvertedPoints","getChange","convertPoints","sender","name","valid","validateCashPayment","validatePointsPayment","getText","handlePaymentType","number","func","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport './styles.css'\n\nimport {\n  Field,\n  Text,\n  TextInput\n} from 'shipnow-mercurio';\n\nimport {\n  Columns,\n  Column\n} from 'bloomer';\n\nimport { withStore } from '../../hocs';\n\nimport { observer } from 'mobx-react';\n\nimport { translate } from '../../lib/Translator';\n\nimport { priceRegex } from '../../lib/Regex'\n\nimport { \n  faCoins,\n  faMoneyBill\n} from \"@fortawesome/free-solid-svg-icons\";\n\n@observer\nclass PaymentForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      paymentType: '',\n      cashHalf: 0,\n      pointsHalf: 0,\n      points: 0,\n      validSplitPayment: false\n    }\n\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  getText( text ) {\n    return translate(text, this.props.store.ui.language)\n  }\n\n  handlePaymentType( type ){\n    this.setState({\n      paymentType: type,\n      cashHalf: 0,\n      pointsHalf: 0,\n      points: 0,\n    })\n    if(type == 'cashAndPoints'){\n      this.props.onChange && this.props.onChange( null, null, 'cashHalf', null )    \n    }else{\n      this.props.onChange && this.props.onChange( null, null, type, null )    \n    }\n\n  }\n\n  validateCashPayment( value ){\n    //agregar mensaje de error\n    return priceRegex.test(value) && value <= this.props.totalAmount\n  }\n\n  validatePointsPayment( value ){\n    return priceRegex.test(value) && value <= this.props.clientPoints && this.getConvertedPoints(value) <= this.props.totalAmount\n  }\n\n  getConvertedPoints(points){\n    return this.props.store.ui.getChange('changePurchase').convertPoints(points)\n  }\n\n  handleChange(sender, value, name, valid){\n    if(name =='cashHalf'){\n      this.setState({\n        cashHalf: value\n      })\n      valid = this.validateCashPayment( value ) && this.validatePointsPayment( this.state.pointsHalf )\n    }\n    if(name =='pointsHalf'){\n      this.setState({\n        pointsHalf: value\n      })\n      valid = this.validateCashPayment( this.state.cashHalf ) && this.validatePointsPayment( value )\n    }\n    if(name == 'points'){\n      this.setState({\n        points: value\n      })\n    }\n\n    this.props.onChange && this.props.onChange(sender, value, name, valid)    \n  }\n\n  render() {\n    return(\n      <React.Fragment>\n        <Field label={ this.getText('Tipo de pago') } labelNote={ this.getText('¿De qué manera desea realizar el pago?') } size=\"lg\">\n          <Text className=\"ml-1 mt-2\" weight=\"medium\" size=\"lg\">\n              <input \n                className=\"ml-1 mr-1\" \n                type=\"radio\" \n                value=\"loaned\" \n                onChange={ () => (this.handlePaymentType('loaned')) }\n                checked={ this.state.paymentType == 'loaned'} />\n              { this.getText('Fiado') }\n          </Text>\n          <Text className=\"ml-1 mt-2\" size=\"lg\" weight=\"medium\">\n              <input \n                className=\"ml-1 mr-1\" \n                type=\"radio\" \n                value=\"cash\" \n                onChange={ () => (this.handlePaymentType('cash')) }\n                checked={ this.state.paymentType == 'cash'} />\n              { this.getText('Efectivo') }\n          </Text>\n          <Text className=\"ml-1 mt-2\" size=\"lg\" weight=\"medium\">\n              <input \n                className=\"ml-1 mr-1\" \n                type=\"radio\" \n                value=\"points\" \n                onChange={ () => (this.handlePaymentType('points')) }\n                checked={ this.state.paymentType == 'points'} />\n              { this.getText('Puntos') }\n          </Text>\n          <Text className=\"ml-1 mt-2\" size=\"lg\" weight=\"medium\">\n              <input \n                className=\"ml-1 mr-1\" \n                type=\"radio\" \n                value=\"cashAndPoints\" \n                onChange={ () => (this.handlePaymentType('cashAndPoints')) }\n                checked={ this.state.paymentType == 'cashAndPoints'} />\n              { this.getText('Efectivo y puntos') }\n          </Text>\n        </Field>\n        {this.state.paymentType != '' && this.state.paymentType != 'loaned' &&\n        <Field className=\"mt-4\" label={ this.getText('Ingrese los montos') } labelNote={ this.getText('¿Cuánto va abonar?') } size=\"lg\">\n\n         {this.state.paymentType == 'cash' && \n         <TextInput icon={ faMoneyBill } name=\"cash\" validate={ (value) => this.validateCashPayment(value) } onChange={ this.handleChange }/>}\n\n         {this.state.paymentType == 'points' && \n         <React.Fragment>\n          <TextInput icon={ faCoins } name=\"points\" validate={ (value) => this.validatePointsPayment(value) } onChange={ this.handleChange }/>\n          <Text>{ `${ this.getText('Equivale a: $') } ${this.getConvertedPoints(this.state.points)}` }</Text>\n         </React.Fragment>}\n         \n         {this.state.paymentType == 'cashAndPoints' && \n          <React.Fragment>\n            <Columns>\n              <Column isSize={ 6 }>\n                <TextInput className=\"mt-1\" icon={ faMoneyBill } name=\"cashHalf\" onChange={ this.handleChange }/>\n              </Column>\n              <Column isSize={ 6 }>\n                <TextInput className=\"mt-1\" icon={ faCoins } name=\"pointsHalf\" onChange={ this.handleChange }/>\n                <Text>{ `${ this.getText('Equivale a: $') } ${this.getConvertedPoints(this.state.pointsHalf)}` }</Text>\n              </Column>\n            </Columns>\n          </React.Fragment>}\n        </Field>}\n      </React.Fragment> )\n  }\n}\n\nPaymentForm.PropTypes = {\n  totalAmount: PropTypes.number,\n  clientPoints: PropTypes.number,\n  onChange: PropTypes.func\n}\n\nPaymentForm.defaultProps = {\n  totalAmount: 0,\n  clientPoints: 0,\n  onChange: null\n}\n\nexport default withStore(PaymentForm);"]},"metadata":{},"sourceType":"module"}